<% html_title(@tracker.name) -%>


<h2><%= @tracker.name %></h2>

<p>

This tracker fetches the document at <br />
  <a id='tracker_uri' href='<%= @tracker.uri %>'><%= @tracker.uri %></a> <br/>
and monitors changes to the element at <br />
  <strong id='tracker_xpath'><%= @tracker.xpath %></strong>

</p>

<% if @tracker.sick? %>
  <p class='sick'>
    This tracker may be sick: Mendono failed to retrieve recent pieces. 
  </p>
<% end %>


<%= link_to 'Destroy', @tracker, :confirm => 'Are you sure?', :method => :delete %>
<h2>Stats</h2>
<p>
This tracker has been created on <%= @tracker.created_at %>, this was XXX days ago.
The last change was recognized 
<abbr class="reltime" title="<%= @tracker.last_change.created_at.iso8601 %>">
 <%= @tracker.last_change.created_at %>
</abbr>

</p>

<p>
So far <%= @tracker.pieces_errorfree.length %> pieces have been fetched which comprise of <strong><%= bytes_to_human(@tracker.bytes_recorded) %></strong>.
Additionaly Trakkor tried to fetch 
<%= @tracker.error_pieces.length %> pieces
which could not be used due to an error. 

<a class='errorchange' href='<%= "#{url_for @tracker}?errors=show" %>'>Display errors</a>
</p>

<h2>Changes</h2>
<table id='changetable'>
<% for change in @changes %>
<% div_for(change) do %>

  <tr>
    <th>
      <span class="reltime"> 
         <%= change.created_at %>
      </span>
      ago
    </th>
  </tr>

<% if change.error %>
  <tr class='errorchange'>
    <td><span class='errorchange'><%= h change.error %></span></td>
  </tr>
<% end %>

<% unless change.error %>
  <tr class='errorchange'>
    <td class='piece'><pre><%= change.text %></pre></td>
  </tr>
<% end %>

<% end %>
<% end %>
</table>


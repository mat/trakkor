<% html_title(@tracker.name) -%>


<h2 class='cozy'><%= @tracker.name %></h2>
<p id='created_on'>created on <%= @tracker.created_at.strftime('%d %b %Y') %></p>

<p>

This tracker fetches the document at <br />
  <a id='tracker_uri' href='<%= @tracker.uri %>'><%= @tracker.uri %></a> <br/>
and monitors the element at <br />
  <strong id='tracker_xpath'><%= @tracker.xpath %></strong>

</p>

<% if @tracker.sick? %>
  <p class='sick'>
    This tracker may be sick: Mendono failed to retrieve recent pieces. 
  </p>
<% end %>


<%= link_to 'Destroy', @tracker, :confirm => 'Are you sure?', :method => :delete %>



<% if @tracker.error_pieces.length > 0 %>
<p>
<%= @tracker.error_pieces.length %> pieces could not be used due to an error: 
<a class='errorchange' href='<%= "#{url_for @tracker}?errors=show" %>'>Show errors</a>
</p>
<% end %>

<h2>Changes</h2>
<table id='changetable'>
<% for change in @changes %>
<% div_for(change) do %>

  <tr>
    <th>
      <span class="reltime"> 
         <%= change.created_at %>
      </span>
      ago
    </th>
  </tr>

<% if change.error %>
  <tr class='errorchange'>
    <td><span class='errorchange'><%= h change.error %></span></td>
  </tr>
<% end %>

<% unless change.error %>
  <tr class='errorchange'>
    <td class='piece'><pre><%= change.text %></pre></td>
  </tr>
<% end %>

<% end %>
<% end %>
</table>

